% \documentclass[lineno,twocolumn,endfloat,biblatex]{biophys-new}
\documentclass{biophys-new}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage[colorlinks,allcolors=cyan!70!black]{hyperref}
\usepackage{glossaries}
\usepackage{textcomp}
\usepackage{subcaption}
\usepackage{comment}
\usepackage{tabularx}
% Uncomment if using biblatex
% \addbibresource{sample.bib}
\newacronym{nka}{NKA}{sodium-potassium ATPase pump}
\title{Model comparison and system analysis of Na+/K+-ATPase using bond graph}
\runningtitle{Biophysical Journal Template} %% For page header

\author[1,*]{First author}
\author[2]{Second author}
\runningauthor{Author1 and Author2} %% For page header

\affil[1]{Institution A, Address A}
\affil[2]{Institution B, Address B}

\corrauthor[*]{abx@xyz.edu}

% \papertype{Letters}
\papertype{Article}
% \papertype{Computational Tools}


\begin{document}


\section*{Introduction}

This document includes the detailed model description of the \Gls{nka} used in the main paper. 


\section*{Methods}

\subsection*{Bond graph model of \Gls{nka} with 15 states}

The reaction scheme can be found in the paper \cite{pan_cardiac_2020}, while we redraw the bond graph in Figure \ref{fig:15state} using the new notation.
\begin{figure}
\centering
\includegraphics[width=0.9\linewidth]{15state.pdf}
\caption{Bond graph of the 15-state model, adapted from \cite{pan_cardiac_2020}.}
\label{fig:15state}
\end{figure}

\input{15state_eqs.tex}

The CellML code of the model is \textit{NKE\_BG\_15\_state.cellml} and the parameters are in \textit{NKE\_BG\_params.cellml},
while the file \textit{NKE\_BG\_Env.cellml} contains the environmental variables and the membrane potentials used in the simulation.
The simulation conditions are in the sedml files listed in \textit{NKE\_BG\_15\_state\_sedmls.json},
while the python scripts to edit and run the sedml files are: \textit{edit\_sedmls\_NKE\_BG\_15\_state.py} and \textit{run\_sedmls\_NKE\_BG\_15\_state.py}.

The steady state flux of the 15-state model is given in the CellML code \textit{Terkildsen\_NaK\_kinetic\_modular.cellml} associated with the paper \cite{pan_cardiac_2020}.
We modified the code to allow the model access to the environmental variables in \textit{NKE\_BG\_Env.cellml} and renamed it as \textit{Terkildsen\_NaK\_kinetic\_modular\_V.cellml}.
The simulation conditions are in the sedml files listed in \textit{Terkildsen\_NaK\_kinetic\_modular\_V\_sedmls.json},
while the python scripts to edit and run the sedml files are: \textit{edit\_sedmls\_Terkildsen\_NaK\_kinetic.py} and \textit{run\_sedmls\_Terkildsen\_NaK\_kinetic\_modular\_V.py}.

\subsection*{Bond graph modes of \Gls{nka} with 6 states}

The bond graph of the 6-state model is shown in Figure \ref{fig:6state_v1}.
\begin{figure}
\caption{Bond graph mode of \Gls{nka} with 6 states.}
      \label{fig:6state_v1}
\centering
\includegraphics[width=0.7\linewidth]{6state_1.pdf}
\end{figure}

\input{6state_eqs.tex}

Table \ref{tab:6state-params} lists the parameters used in the 6-state model.
\begin{table}[h]
\centering
\caption{Parameters used in the 6-state model.}
\label{tab:6state-params}
\begin{tabular}{l l l}
\hline
Parameter & Value & Unit \\
\hline
\hline
$\kappa_1$ & 2838.887577221678 & $fmol \cdot s^{-1}$ \\
$\kappa_2$ & 51.10219437844171 & $fmol \cdot s^{-1}$\\
$\kappa_3$ & 469.3484263577967& $fmol \cdot s^{-1}$ \\
$\kappa_4$ & 619068.2941716437 & $fmol \cdot s^{-1}$ \\
$\kappa_5$ & 35.86695382215395& $fmol \cdot s^{-1}$ \\
$\kappa_6$ & 868.3565212763533 & $fmol \cdot s^{-1}$ \\
$K_1$ & 0.01672750157200864 & $fmol^{-1}$ \\
$K_2$ & 4477.021060951143  & $fmol^{-1}$ \\
$K_3$ & 46639.870922646594 & $fmol^{-1}$ \\
$K_4$ & 720.5754433721395  & $fmol^{-1}$ \\
$K_5$ & 1.6068992551751866 & $fmol^{-1}$ \\
$K_6$ & 30254.315059094864 & $fmol^{-1}$ \\
$z_1$ & 0.945049 & dimensionless \\
$z_2$ & -0.054951 & dimensionless \\
\hline
\end{tabular}
\end{table}

% Table file name, description of the file
Table \ref{tab:6state-files} lists and describes the files related to the 6-state model.
\begin{table}
\centering
\caption{Description of the files related to the 6-state model.}
\label{tab:6state-files}
\begin{tabularx}{\linewidth}{p{8cm} X }
\hline
File name & Description \\
\hline
\hline
\textit{NKE\_BG\_6\_state\_ATPNaZKV2.cellml} & CellML code of the 6-state model \\
\textit{NKE\_BG\_6\_state\_ATPNaZKV2\_SS.cellml} & CellML code of the steady state flux of the 6-state model \\
\textit{NKE\_BG\_6\_state\_ATPNaZKV2\_fixedV.cellml} & CellML code of the 6-state model with fixed membrane potential \\
\textit{NKE\_BG\_6\_state\_ATPNaZKV2\_SS\_fixedV.cellml} & CellML code of the steady state flux of the 6-state model with fixed membrane potential \\
\textit{NKE\_BG\_6\_state\_ATPNaZKV2\_param.cellml} & Parameters for the 6-state model \\
\textit{NKE\_BG\_6\_state\_ATPNaZKV2\_sedmls.json} & The list of sedml files for the 6-state model \\
\textit{NKE\_BG\_6\_state\_ATPNaZKV2\_fixedV\_sedmls.json} & The list of sedml files for the 6-state model with fixed membrane potential \\
\textit{NKE\_BG\_6\_state\_ATPNaZKV2\_SS\_sedmls.json} & The list of sedml files for the steady state flux of the 6-state model \\
\textit{NKE\_BG\_6\_state\_ATPNaZKV2\_SS\_fixedV\_sedmls.json} & The list of sedml files for the steady state flux of the 6-state model with fixed membrane potential \\
\textit{edit\_sedmls\_NKE\_BG\_6\_state\_ATPNaZKV2.py} & Python script to edit the sedml files for the 6-state model \\
\textit{run\_sedmls\_NKE\_BG\_6\_state\_ATPNaZKV2.py} & Python script to run the sedml files for the 6-state model \\
\hline
\end{tabularx}     
\end{table}

\subsection*{Instructions to run the simulations and reproduce the figures}

The CellML and sedml files are in workspace \url{https://models.physiomeproject.org/workspace/cad}, while the python scripts are in Github repository \url{https://github.com/WeiweiAi/EA_NKE}.
Since the Github repository includes sumbodules, please clone the repository using the command:
\begin{verbatim}
git clone https://github.com/WeiweiAi/EA_NKE.git --recurse-submodules
\end{verbatim}

The procedures to run the simulations and reproduce the figures are described below:
\begin{enumerate}
    \item Run \textit{run\_sedmls\_Terkildsen\_NaK\_kinetic\_modular\_V.py} to get the data of the steady state flux of the 15-state model under varying conditions.
    \item Run \textit{run\_sedmls\_NKE\_BG\_15\_state.py} to get the data of the full bond graph of the 15-state model under varying conditions.
    \item Run \textit{run\_sedmls\_NKE\_BG\_6\_state\_ATPNaZKV2.py} to run the simulations of the 6-state models under varying conditions.
    \item Run \textit{EA\_calc\_6stateV2.py} to calculate the energetic quantities of the 6-state model under varying conditions.
    \item Run \textit{EA\_calc\_15state.py} to calculate the energetic quantities of the 15-state model under varying conditions.
    \item Run \textit{plot\_original\_ssV2.py} to reproduce Figure 4 in the main paper.
    \item Run \textit{plot\_EA\_flow\_6stateV2.py}, \textit{plot\_EA\_flow\_15state.py} and \textit{plot\_EA\_bar\_heatV2.py} to reproduce Figure 5 in the main paper.
    \item Run \textit{plot\_EA\_2D\_combine15state.py} and \textit{plot\_EA\_2D\_combine6stateV2.py} to reproduce Figure 6 in the main paper.
    \item  Run \textit{plot\_EA\_2D\_combine15state\_deltaATP.py} and \textit{plot\_EA\_2D\_combine6stateV2\_deltaATP.py} to reproduce Figures 7,8 and 9 in the main paper.
    \item  Run \textit{plot\_EA\_2D\_combine15state\_flowRate.py} and \textit{plot\_EA\_2D\_combine6stateV2\_flowRate.py} to reproduce Figure 10 in the main paper. 
    \item  Run \textit{plot\_EA\_2D\_combine15state\_NaK.py} and \textit{plot\_EA\_2D\_combine6stateV2\_NaK.py} to reproduce Figure 10 in the main paper.  
\end{enumerate}  

% Uncomment if using bibtex (default)
\bibliography{sample}

% Uncomment if using biblatex
% \printbibliography

\end{document}
